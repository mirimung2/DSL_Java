## JVM은 무엇이며 자바 코드는 어떻게 실행하는 것인가.

### 목표
자바 소스 파일(.java)을 JVM으로 실행하는 과정 이해하기.   

![image](https://user-images.githubusercontent.com/91665030/135759023-9f256edd-988a-44a9-901a-887379502720.png)   

### 학습할 것
* JVM이란 무엇인가   
  > JVM은 Java Virtual Machine의 약자로 자바 가상 머신을 뜻한다.   
  > 가상 머신은 실제 컴퓨터와 동일한 기능을 소프트웨어로 구현한 것이다.   
  > 따라서 JVM은 시스템 메모리를 관리하며 자바 기반 애플리케이션을 위해 이식 가능한 실행 환경을 제공한다.   
  > JVM은 자바 바이트 코드를 실행시키기 위함이며, .class 파일을 인터프리터와 JIT 컴파일러로 OS에 맞는 machine code로 변환한다.   
  > 단, OS에 종속적이라 각 운영체제에 맞는 JVM을 설치해야 한다.   

* 컴파일 하는 방법
  > .java가 확장자인 텍스트 파일을 javac 명령어를 통해 컴파일 할 수 있다.   
  > 컴파일하면 .class 파일이 생성된다.   

* 실행하는 방법
  > 컴파일을 통해 .class 파일이 생성됐다면 java 명령어를 통해 JVM으로 프로그램을 실행할 수 있다.   

* 바이트코드란 무엇인가
  > JVM이 이해할 수 있는 언어로 변환된 자바 소스 코드이다.
  > 자바 컴파일러에 의해 변환되는 코드의 명렁어 크기가 1바이트라 바이트코드라 한다.
  > 확장자는 .class 이며, JVM이 설치되어 있다면 자바 바이트코드는 어떤 운영체제에서라도 실행 가능하다.   

* JIT 컴파일러란 무엇이며 어떻게 동작하는지
  > JIT는 Just-In-Time의 약자이며, JIT 컴파일러는 인터프리터 방식의 단점을 보완하기 위해 도입됐다.   
  > 인터프리터 읽을 때의 속도 효율성을 JIT 컴파일러가 보완하는 형태이다. 
  > 인터프리터 방식으로 실행하다가 적절한 시점에 바이트코드 전체를 컴파일하여 네이티브 코드로 변경하고, 이후에는 더이상 인터프리팅 하지 않고 네이티브 코드로 직접 실행하는 방식이다.   
  > 자바 컴파일러가 생성한 자바 바이트 코드를 런타임에 바로 기계어로 변환하는 데 사용한다.   
  > 바이트 코드에서 반복되는 코드 부분은 JIT 컴파일러가 미리 네이티브 코드로 변환시켜놓는다.   
  > 반복되는 코드가 읽힐 순서가 왔을 때, 인터프리터로 읽지 않고 바로 네이티브 코드를 사용한다.   
  > 네이티브 코드는 캐시에 보관하기 때문에 한 번 컴파일된 코드는 빠르게 수행한다.   
  > JIT 컴파일러가 컴파일하는 과정은 바이트코드를 인터프리팅하는 것보다 훨씬 오래 걸리므로 한 번만 실행되는 코드라면 컴파일하지 않고 인터프리팅하는 것이 유리하다.   
  > JIT 컴파일러를 사용하는 JVM들은 내부적으로 해당 method가 얼마나 자주 수행되는지 체크하고, 일정 정도를 넘을때에만 컴파일을 수행한다.   

* JVM 구성 요소
  > - Class Loader   
  > : 바이트 코드를 읽어오며 메모리에 적절히 배치하는 역할을 한다.   
  > JVM 내로 클래스(.class파일)를 로드하고, 링크를 통해 배치하는 작업을 수행하는 모듈이다.   
  > Runtime 시에 동적으로 클래스를 로드한다.   
  > 로딩 - .class 를 읽어옴   
  > 링크 - 코드 내부의 레퍼런스를 연결   
  > 초기화 - 클래스에 있는 static 값들을 초기화함   
  >    
  > - Execution Engine   
  > : 클래스를 실행시키는 역할을 한다.   
  > 클래스 로더가 JVM 내의 런타임 데이터 영역에 바이트 코드를 배치시키면 Execution Engine(실행 엔진)에 의해 실행된다.   
  > 
  > - Garbage Collector   
  > : 더는 사용하지 않는 메모리를 자동으로 회수하여 정리한다.   
  > 즉, 더 이상 참조되지 않는 객체들을 탐색 후 제거하는 역할을 한다.   
  > 따라서 개발자가 따로 메모리 관리하지 않아도 되므로 더욱 손쉽게 프로그래밍 할 수 있도록 도와준다.   
  > 
  > - Runtime Data Area   
  > : JVM의 메모리 영역으로 자바 애플리케이션을 실행할 때 사용되는 데이터들을 적재하는 역할을 한다.   
  > JVM이 프로그램을 수행하기 위해 OS로부터 별도로 할당받은 메모리공간이다.   
  > Runtime Data Area는 다음과 같이 크게 5가지 영역으로 나눌 수 있다.
  > ![image](https://user-images.githubusercontent.com/91665030/135757392-d158bda4-fe95-4a6f-85f7-c2a3cae1c943.png)

* JDK와 JRE의 차이
  > - JDK(Java Development Kit)   
  > : JRE + 개발 툴 (Java C)   
  > JRE 뿐 아니라 새로운 프로그램을 개발하기 위한 라이브러리, javac 명령어 등을 포함한다.   
  > 자바 프로그래머는 JDK를 받아 사용한다.   
  > Java 9 버전부터는 JRE가 따로 만들어지지 않고, JDK에 패키징되어 출시된다.   
  > - JRE(Java Runtime Environment)   
  > : JVM + 핵심 라이브러리   
  > 개발 관련 X, 실행 관련 O   
  > Java는 보통 JRE 단위로 배포한다.   
  > 자바 프로그램을 실행시키는 데 필요한 라이브러리, Java  명령어, JVM 등을 의미한다.   
  > 환경적인 요소이기 때문에 JRE만 가지고 새로운 프로그램을 개발할 수 없다.   

#### 참조
https://asfirstalways.tistory.com/158   
https://www.itworld.co.kr/news/110837   
https://jeong-pro.tistory.com/148   
https://medium.com/@lazysoul/jvm-%EC%9D%B4%EB%9E%80-c142b01571f2   
https://dailyheumsi.tistory.com/196   
http://www.tcpschool.com/java/java_intro_programming   
https://velog.io/@maigumi/1.-JVM%EA%B3%BC-%EC%9E%90%EB%B0%94-%EC%BD%94%EB%93%9C%EC%9D%98-%EC%8B%A4%ED%96%89-%EB%B0%A9%EB%B2%95
